<p align="center">
    <img src="../../assets/readme/icon.png" width="250"/>
</p>
<div align="center">
    <a href="https://github.com/hpcaitech/Open-Sora/stargazers"><img src="https://img.shields.io/github/stars/hpcaitech/Open-Sora?style=social"></a>
    <a href="https://hpcaitech.github.io/Open-Sora/"><img src="https://img.shields.io/badge/Gallery-View-orange?logo=&amp"></a>
    <a href="https://discord.gg/kZakZzrSUT"><img src="https://img.shields.io/badge/Discord-join-blueviolet?logo=discord&amp"></a>
    <a href="https://join.slack.com/t/colossalaiworkspace/shared_invite/zt-247ipg9fk-KRRYmUl~u2ll2637WRURVA"><img src="https://img.shields.io/badge/Slack-ColossalAI-blueviolet?logo=slack&amp"></a>
    <a href="https://twitter.com/yangyou1991/status/1769411544083996787?s=61&t=jT0Dsx2d-MS5vS9rNM5e5g"><img src="https://img.shields.io/badge/Twitter-Discuss-blue?logo=twitter&amp"></a>
    <a href="https://raw.githubusercontent.com/hpcaitech/public_assets/main/colossalai/img/WeChat.png"><img src="https://img.shields.io/badge/å¾®ä¿¡-å°åŠ©æ‰‹åŠ ç¾¤-green?logo=wechat&amp"></a>
    <a href="https://hpc-ai.com/blog/open-sora-v1.0"><img src="https://img.shields.io/badge/Open_Sora-Blog-blue"></a>
    <a href="https://huggingface.co/spaces/hpcai-tech/open-sora"><img src="https://img.shields.io/badge/%F0%9F%A4%97%20Hugging%20Face-Gradio Demo-blue"></a>
</div>

## Open-Sora: è®©æ‰€æœ‰äººéƒ½èƒ½è½»æ¾åˆ¶ä½œé«˜æ•ˆè§†é¢‘

æˆ‘ä»¬è®¾è®¡å¹¶å®æ–½äº†**Open-Sora**ï¼Œè¿™æ˜¯ä¸€é¡¹è‡´åŠ›äºé«˜æ•ˆåˆ¶ä½œé«˜è´¨é‡è§†é¢‘çš„è®¡åˆ’ã€‚æˆ‘ä»¬å¸Œæœ›è®©æ‰€æœ‰äººéƒ½èƒ½ä½¿ç”¨æ¨¡å‹ã€å·¥å…·å’Œæ‰€æœ‰ç»†èŠ‚ã€‚é€šè¿‡é‡‡ç”¨å¼€æºåŸåˆ™ï¼ŒOpen-Sora ä¸ä»…ä½¿é«˜çº§è§†é¢‘ç”ŸæˆæŠ€æœ¯çš„ä½¿ç”¨å˜å¾—æ°‘ä¸»åŒ–ï¼Œè€Œä¸”è¿˜æä¾›äº†ä¸€ä¸ªç®€åŒ–ä¸”ç”¨æˆ·å‹å¥½çš„å¹³å°ï¼Œç®€åŒ–äº†è§†é¢‘ç”Ÿæˆçš„å¤æ‚æ€§ã€‚å€ŸåŠ© Open-Soraï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯åœ¨å†…å®¹åˆ›ä½œé¢†åŸŸä¿ƒè¿›åˆ›æ–°ã€åˆ›é€ åŠ›å’ŒåŒ…å®¹æ€§ã€‚

[[ä¸­æ–‡æ–‡æ¡£](/docs/zh_CN/README.md)] [[æ½æ™¨äº‘](https://cloud.luchentech.com/)|[OpenSoraé•œåƒ](https://cloud.luchentech.com/doc/docs/image/open-sora/)|[è§†é¢‘æ•™ç¨‹](https://www.bilibili.com/video/BV1ow4m1e7PX/?vd_source=c6b752764cd36ff0e535a768e35d98d2)]

## ğŸ“° èµ„è®¯

* **[2024.12.23]** ğŸ”¥[è§†é¢‘ç”Ÿæˆæ¨¡å‹å¼€å‘æˆæœ¬ç›´é™50%ï¼Œå¼€æºè§£å†³æ–¹æ¡ˆæ¥äº†ï¼Œè¿˜èƒ½ç™½å«–GPUç®—åŠ›](https://company.hpc-ai.com/blog/the-development-cost-of-video-generation-models-has-saved-by-50-open-source-solutions-are-now-available-with-h200-gpu-vouchers)  [[ä»£ç ]](https://github.com/hpcaitech/Open-Sora/blob/main/scripts/train.py) [[ä»£é‡‘åˆ¸]](https://colossalai.org/zh-Hans/docs/get_started/bonus/)
* **[2024.06.22]** ğŸ”¥æˆ‘ä»¬åœ¨[æ½æ™¨äº‘](https://cloud.luchentech.com/)ä¸Šå‘å¸ƒäº†Open-Sora1.2é•œåƒï¼Œå¹¶åœ¨Bç«™ä¸Šä¼ äº†è¯¦ç»†çš„[ä½¿ç”¨æ•™ç¨‹](https://www.bilibili.com/video/BV1ow4m1e7PX/)
* **[2024.06.17]** ğŸ”¥æˆ‘ä»¬å‘å¸ƒäº†**Open-Sora 1.2**ï¼Œå…¶ä¸­åŒ…æ‹¬**3D-VAE**ï¼Œ**æ•´æµæµ**å’Œ**å¾—åˆ†æ¡ä»¶**ã€‚è§†é¢‘è´¨é‡å¤§å¤§æé«˜ã€‚[[æ¨¡å‹æƒé‡]](#æ¨¡å‹æƒé‡) [[æŠ€æœ¯æŠ¥å‘Š]](report_v3.md) [[å…¬ä¼—å·æ–‡ç« ]](https://mp.weixin.qq.com/s/QHq2eItZS9e00BVZnivdjg)
* **[2024.04.25]** ğŸ¤— æˆ‘ä»¬åœ¨ Hugging Face Spaces ä¸Šå‘å¸ƒäº† [Open-Soraçš„Gradioæ¼”ç¤º](https://huggingface.co/spaces/hpcai-tech/open-sora)ã€‚
* **[2024.04.25]** æˆ‘ä»¬å‘å¸ƒäº†**Open-Sora 1.1**ï¼Œæ”¯æŒ**2s~15sã€144p åˆ° 720pã€ä»»æ„æ¯”ä¾‹çš„æ–‡æœ¬è½¬å›¾ç‰‡ã€æ–‡æœ¬è½¬è§†é¢‘ã€å›¾ç‰‡è½¬è§†é¢‘ã€è§†é¢‘è½¬è§†é¢‘ã€æ— é™æ—¶é—´ç”Ÿæˆ**ã€‚æ­¤å¤–ï¼Œè¿˜å‘å¸ƒäº†å®Œæ•´çš„è§†é¢‘å¤„ç†ç®¡é“ã€‚ [[æ¨¡å‹æƒé‡]](#æ¨¡å‹æƒé‡) [[æŠ€æœ¯æŠ¥å‘Š]](report_v2.md)[[å…¬ä¼—å·æ–‡ç« ]](https://mp.weixin.qq.com/s/nkPSTep2se__tzp5OfiRQQ)
* **[2024.03.18]** æˆ‘ä»¬å‘å¸ƒäº† **Open-Sora 1.0**, ä¸€ä¸ªå®Œå…¨å¼€æºçš„è§†é¢‘ç”Ÿæˆé¡¹ç›®ã€‚Open-Sora 1.0 æ”¯æŒå®Œæ•´çš„è§†é¢‘æ•°æ®é¢„å¤„ç†æµç¨‹ã€åŠ é€Ÿè®­ç»ƒ
  <a href="https://github.com/hpcaitech/ColossalAI"><img src="/assets/readme/colossal_ai.png" width="8%" ></a>
ã€æ¨ç†ç­‰ã€‚æˆ‘ä»¬çš„æ¨¡å‹åªéœ€ 3 å¤©çš„è®­ç»ƒå°±å¯ä»¥ç”Ÿæˆ 2 ç§’çš„ 512x512 è§†é¢‘ã€‚ [[æ¨¡å‹æƒé‡]](#æ¨¡å‹æƒé‡)
  [[å…¬ä¼—å·æ–‡ç« ]](https://mp.weixin.qq.com/s/H52GW8i4z1Dco3Sg--tCGw) [[æŠ€æœ¯æŠ¥å‘Š]](report_v1.md)
* **[2024.03.04]** Open-Sora æä¾›åŸ¹è®­ï¼Œæˆæœ¬é™ä½ 46%ã€‚
  [[å…¬ä¼—å·æ–‡ç« ]](https://mp.weixin.qq.com/s/OjRUdrM55SufDHjwCCAvXg)

## ğŸ¥ Latest Demo

ğŸ”¥ æ‚¨å¯ä»¥åœ¨HuggingFaceä¸Šçš„ [ğŸ¤— Gradioåº”ç”¨ç¨‹åº](https://huggingface.co/spaces/hpcai-tech/open-sora)ä¸Šä½“éªŒOpen-Sora. æˆ‘ä»¬çš„[ç”»å»Š](https://hpcaitech.github.io/Open-Sora/)ä¸­æä¾›äº†æ›´å¤šç¤ºä¾‹.

| **4s 720Ã—1280**                                                                                                                                      | **4s 720Ã—1280**                                                                                                                                      | **4s 720Ã—1280**                                                                                                                                      |
| ---------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------- |
| [<img src="/assets/demo/v1.2/sample_0013.gif" width="">](https://github.com/hpcaitech/Open-Sora/assets/99191637/7895aab6-ed23-488c-8486-091480c26327) | [<img src="/assets/demo/v1.2/sample_1718.gif" width="">](https://github.com/hpcaitech/Open-Sora/assets/99191637/20f07c7b-182b-4562-bbee-f1df74c86c9a) | [<img src="/assets/demo/v1.2/sample_0087.gif" width="">](https://github.com/hpcaitech/Open-Sora/assets/99191637/3d897e0d-dc21-453a-b911-b3bda838acc2) |
| [<img src="/assets/demo/v1.2/sample_0052.gif" width="">](https://github.com/hpcaitech/Open-Sora/assets/99191637/644bf938-96ce-44aa-b797-b3c0b513d64c) | [<img src="/assets/demo/v1.2/sample_1719.gif" width="">](https://github.com/hpcaitech/Open-Sora/assets/99191637/272d88ac-4b4a-484d-a665-8d07431671d0) | [<img src="/assets/demo/v1.2/sample_0002.gif" width="">](https://github.com/hpcaitech/Open-Sora/assets/99191637/ebbac621-c34e-4bb4-9543-1c34f8989764) |
| [<img src="/assets/demo/v1.2/sample_0011.gif" width="">](https://github.com/hpcaitech/Open-Sora/assets/99191637/a1e3a1a3-4abd-45f5-8df2-6cced69da4ca) | [<img src="/assets/demo/v1.2/sample_0004.gif" width="">](https://github.com/hpcaitech/Open-Sora/assets/99191637/d6ce9c13-28e1-4dff-9644-cc01f5f11926) | [<img src="/assets/demo/v1.2/sample_0061.gif" width="">](https://github.com/hpcaitech/Open-Sora/assets/99191637/561978f8-f1b0-4f4d-ae7b-45bec9001b4a) |

<details>
<summary>OpenSora 1.1 æ¼”ç¤º</summary>

| **2ç§’ 240Ã—426**                                                                                                                                              | **2ç§’ 240Ã—426**                                                                                                                                             |
| ----------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------- |
| [<img src="/assets/demo/sample_16x240x426_9.gif" width="">](https://github.com/hpcaitech/Open-Sora-dev/assets/99191637/c31ebc52-de39-4a4e-9b1e-9211d45e05b2) | [<img src="/assets/demo/sora_16x240x426_26.gif" width="">](https://github.com/hpcaitech/Open-Sora-dev/assets/99191637/c31ebc52-de39-4a4e-9b1e-9211d45e05b2) |
| [<img src="/assets/demo/sora_16x240x426_27.gif" width="">](https://github.com/hpcaitech/Open-Sora-dev/assets/99191637/f7ce4aaa-528f-40a8-be7a-72e61eaacbbd)  | [<img src="/assets/demo/sora_16x240x426_40.gif" width="">](https://github.com/hpcaitech/Open-Sora-dev/assets/99191637/5d58d71e-1fda-4d90-9ad3-5f2f7b75c6a9) |

| **2ç§’ 426Ã—240**                                                                                                                                             | **4ç§’ 480Ã—854**                                                                                                                                              |
| ---------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------- |
| [<img src="/assets/demo/sora_16x426x240_24.gif" width="">](https://github.com/hpcaitech/Open-Sora-dev/assets/99191637/34ecb4a0-4eef-4286-ad4c-8e3a87e5a9fd) | [<img src="/assets/demo/sample_32x480x854_9.gif" width="">](https://github.com/hpcaitech/Open-Sora-dev/assets/99191637/c1619333-25d7-42ba-a91c-18dbc1870b18) |

| **16ç§’ 320Ã—320**                                                                                                                                        | **16ç§’ 224Ã—448**                                                                                                                                        | **2ç§’ 426Ã—240**                                                                                                                                            |
| ------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------ | --------------------------------------------------------------------------------------------------------------------------------------------------------- |
| [<img src="/assets/demo/sample_16s_320x320.gif" width="">](https://github.com/hpcaitech/Open-Sora/assets/99191637/3cab536e-9b43-4b33-8da8-a0f9cf842ff2) | [<img src="/assets/demo/sample_16s_224x448.gif" width="">](https://github.com/hpcaitech/Open-Sora/assets/99191637/9fb0b9e0-c6f4-4935-b29e-4cac10b373c4) | [<img src="/assets/demo/sora_16x426x240_3.gif" width="">](https://github.com/hpcaitech/Open-Sora-dev/assets/99191637/3e892ad2-9543-4049-b005-643a4c1bf3bf) |


</details>

<details>
<summary>OpenSora 1.0 Demo</summary>

| **2ç§’ 512Ã—512**                                                                                                                                                                 | **2ç§’ 512Ã—512**                                                                                                                                                              | **2ç§’ 512Ã—512**                                                                                                                                    |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------- |
| [<img src="/assets/readme/sample_0.gif" width="">](https://github.com/hpcaitech/Open-Sora/assets/99191637/de1963d3-b43b-4e68-a670-bb821ebb6f80)                                 | [<img src="/assets/readme/sample_1.gif" width="">](https://github.com/hpcaitech/Open-Sora/assets/99191637/13f8338f-3d42-4b71-8142-d234fbd746cc)                              | [<img src="/assets/readme/sample_2.gif" width="">](https://github.com/hpcaitech/Open-Sora/assets/99191637/fa6a65a6-e32a-4d64-9a9e-eabb0ebb8c16)    |
|æ£®æ—åœ°åŒºå®é™çš„å¤œæ™¯ã€‚ [...] è¯¥è§†é¢‘æ˜¯ä¸€æ®µå»¶æ—¶æ‘„å½±ï¼Œæ•æ‰äº†ç™½å¤©åˆ°å¤œæ™šçš„è½¬å˜ï¼Œæ¹–æ³Šå’Œæ£®æ—å§‹ç»ˆä½œä¸ºèƒŒæ™¯ã€‚ | æ— äººæœºæ‹æ‘„çš„é•œå¤´æ•æ‰åˆ°äº†æµ·å²¸æ‚¬å´–çš„å£®ä¸½ç¾æ™¯ï¼Œ[...] æµ·æ°´è½»è½»åœ°æ‹æ‰“ç€å²©çŸ³åº•éƒ¨å’Œç´§è´´æ‚¬å´–é¡¶éƒ¨çš„ç»¿è‰²æ¤ç‰©ã€‚| ç€‘å¸ƒä»æ‚¬å´–ä¸Šå€¾æ³»è€Œä¸‹ï¼Œæµå…¥å®é™çš„æ¹–æ³Šï¼Œæ°”åŠ¿ç£…ç¤´ã€‚[...] æ‘„åƒæœºè§’åº¦æä¾›äº†ç€‘å¸ƒçš„é¸Ÿç°å›¾ã€‚ |
| [<img src="/assets/readme/sample_3.gif" width="">](https://github.com/hpcaitech/Open-Sora/assets/99191637/64232f84-1b36-4750-a6c0-3e610fa9aa94)                                 | [<img src="/assets/readme/sample_4.gif" width="">](https://github.com/hpcaitech/Open-Sora/assets/99191637/983a1965-a374-41a7-a76b-c07941a6c1e9)                              | [<img src="/assets/readme/sample_5.gif" width="">](https://github.com/hpcaitech/Open-Sora/assets/99191637/ec10c879-9767-4c31-865f-2e8d6cf11e65)    |
| å¤œæ™šç¹åçš„åŸå¸‚è¡—é“ï¼Œå……æ»¡äº†æ±½è½¦å‰ç¯çš„å…‰èŠ’å’Œè·¯ç¯çš„æ°›å›´å…‰ã€‚ [...]                                                           | å‘æ—¥è‘µç”°çš„ç”Ÿæœºå‹ƒå‹ƒï¼Œç¾ä¸èƒœæ”¶ã€‚å‘æ—¥è‘µæ•´é½æ’åˆ—ï¼Œç»™äººä¸€ç§ç§©åºæ„Ÿå’Œå¯¹ç§°æ„Ÿã€‚ [...]                                            |å®é™çš„æ°´ä¸‹åœºæ™¯ï¼Œä¸€åªæµ·é¾Ÿåœ¨çŠç‘šç¤ä¸­æ¸¸åŠ¨ã€‚è¿™åªæµ·é¾Ÿçš„å£³å‘ˆç»¿è¤è‰² [...]                   |

è§†é¢‘ç»è¿‡é™é‡‡æ ·ä»¥.gifç”¨äºæ˜¾ç¤ºã€‚å•å‡»æŸ¥çœ‹åŸå§‹è§†é¢‘ã€‚æç¤ºç»è¿‡ä¿®å‰ªä»¥ç”¨äºæ˜¾ç¤ºï¼Œè¯·å‚é˜…[æ­¤å¤„](/assets/texts/t2v_samples.txt)æŸ¥çœ‹å®Œæ•´æç¤ºã€‚

</details>

## ğŸ”† æ–°åŠŸèƒ½/æ›´æ–°

* ğŸ“ **Open-Sora 1.2** å‘å¸ƒã€‚æ¨¡å‹æƒé‡å¯åœ¨[æ­¤å¤„](#model-weights)æŸ¥çœ‹ã€‚æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…æˆ‘ä»¬çš„**[æŠ€æœ¯æŠ¥å‘Š v1.2](docs/report_03.md)** ã€‚
* âœ… æ”¯æŒæ•´æµæµè°ƒåº¦ã€‚
* âœ… è®­ç»ƒæˆ‘ä»¬çš„ 3D-VAE è¿›è¡Œæ—¶é—´ç»´åº¦å‹ç¼©ã€‚
* ğŸ“ **Open-Sora 1.1**å‘å¸ƒã€‚æ¨¡å‹æƒé‡å¯åœ¨[æ­¤å¤„](#model-weights)è·å¾—ã€‚å®ƒé’ˆå¯¹**0s~15sã€144p åˆ° 720pã€å„ç§å®½é«˜æ¯”**çš„è§†é¢‘è¿›è¡Œè®­ç»ƒã€‚æœ‰å…³æ›´å¤šè®¨è®ºï¼Œè¯·å‚é˜…æˆ‘ä»¬çš„**[æŠ€æœ¯æŠ¥å‘Š v1.1](/docs/report_02.md)** ã€‚
* ğŸ”§ **æ•°æ®å¤„ç†æµç¨‹** v1.1å‘å¸ƒï¼Œæä¾›ä»åŸå§‹è§†é¢‘åˆ°ï¼ˆæ–‡æœ¬ï¼Œè§†é¢‘ç‰‡æ®µï¼‰å¯¹çš„è‡ªåŠ¨å¤„ç†æµç¨‹ï¼ŒåŒ…æ‹¬åœºæ™¯å‰ªåˆ‡$\rightarrow$è¿‡æ»¤ï¼ˆç¾å­¦ã€å…‰æµã€OCR ç­‰ï¼‰$\rightarrow$å­—å¹•$\rightarrow$ç®¡ç†ã€‚ä½¿ç”¨æ­¤å·¥å…·ï¼Œæ‚¨å¯ä»¥è½»æ¾æ„å»ºè§†é¢‘æ•°æ®é›†ã€‚
* âœ… æ”¹è¿›çš„ ST-DiT æ¶æ„åŒ…æ‹¬ rope ä½ç½®ç¼–ç ã€qk èŒƒæ•°ã€æ›´é•¿çš„æ–‡æœ¬é•¿åº¦ç­‰ã€‚
* âœ… æ”¯æŒä»»æ„åˆ†è¾¨ç‡ã€çºµæ¨ªæ¯”å’Œæ—¶é•¿ï¼ˆåŒ…æ‹¬å›¾åƒï¼‰çš„è®­ç»ƒã€‚
* âœ… æ”¯æŒå›¾åƒå’Œè§†é¢‘è°ƒèŠ‚ä»¥åŠè§†é¢‘ç¼–è¾‘ï¼Œä»è€Œæ”¯æŒåŠ¨ç”»å›¾åƒï¼Œè¿æ¥è§†é¢‘ç­‰ã€‚
* ğŸ“ **Open-Sora 1.0**å‘å¸ƒã€‚æ¨¡å‹æƒé‡å¯åœ¨[æ­¤å¤„](#model-weights)è·å¾—ã€‚ä»…ä½¿ç”¨ 400K è§†é¢‘ç‰‡æ®µå’Œ 200 ä¸ª H800 å¤©ï¼ˆç›¸æ¯”ç¨³å®šè§†é¢‘æ‰©æ•£ä¸­çš„ 152M æ ·æœ¬ï¼‰ï¼Œæˆ‘ä»¬å°±èƒ½ç”Ÿæˆ 2s 512Ã—512 è§†é¢‘ã€‚æœ‰å…³æ›´å¤šè®¨è®ºï¼Œè¯·å‚é˜…æˆ‘ä»¬çš„**[æŠ€æœ¯æŠ¥å‘Š v1.0](docs/report_01.md)**ã€‚
* âœ…ä»å›¾åƒæ‰©æ•£æ¨¡å‹åˆ°è§†é¢‘æ‰©æ•£æ¨¡å‹çš„ä¸‰é˜¶æ®µè®­ç»ƒã€‚æˆ‘ä»¬ä¸ºæ¯ä¸ªé˜¶æ®µæä¾›æƒé‡ã€‚
* âœ… æ”¯æŒè®­ç»ƒåŠ é€Ÿï¼ŒåŒ…æ‹¬åŠ é€Ÿ Transformerã€æ›´å¿«çš„ T5 å’Œ VAE ä»¥åŠåºåˆ—å¹¶è¡Œã€‚Open-Sora åœ¨ 64x512x512 è§†é¢‘ä¸Šè®­ç»ƒæ—¶å¯å°†è®­ç»ƒé€Ÿåº¦æé«˜**55%**ã€‚è¯¦ç»†ä¿¡æ¯ä½äº[è®­ç»ƒåŠ é€Ÿ.md](docs/acceleration.md)ã€‚
* ğŸ”§ **æ•°æ®é¢„å¤„ç†æµç¨‹ v1.0**,åŒ…æ‹¬ [ä¸‹è½½](tools/datasets/README.md), [è§†é¢‘å‰ªè¾‘](tools/scene_cut/README.md), å’Œ [å­—å¹•](tools/caption/README.md) å·¥å…·. æˆ‘ä»¬çš„æ•°æ®æ”¶é›†è®¡åˆ’å¯åœ¨ [æ•°æ®é›†.md](docs/datasets.md)ä¸­æ‰¾åˆ°.

<details>
<summary>æŸ¥çœ‹æ›´å¤š</summary>

âœ… æˆ‘ä»¬å‘ç°[VideoGPT](https://wilson1yan.github.io/videogpt/index.html)çš„ VQ-VAEè´¨é‡è¾ƒä½ï¼Œå› æ­¤é‡‡ç”¨äº†[Stability-AI](https://huggingface.co/stabilityai/sd-vae-ft-mse-original)ä¸­çš„æ›´å¥½çš„ VAE ã€‚æˆ‘ä»¬è¿˜å‘ç°æ—¶é—´ç»´åº¦çš„ä¿®è¡¥ä¼šé™ä½è´¨é‡ã€‚æœ‰å…³æ›´å¤šè®¨è®ºï¼Œè¯·å‚é˜…æˆ‘ä»¬çš„**[æŠ€æœ¯æŠ¥å‘Šv1.0](docs/report_01.md)**ã€‚
âœ… æˆ‘ä»¬ç ”ç©¶äº†ä¸åŒçš„æ¶æ„ï¼ŒåŒ…æ‹¬ DiTã€Latte å’Œæˆ‘ä»¬æå‡ºçš„ **STDiT**ã€‚æˆ‘ä»¬çš„STDiTåœ¨è´¨é‡å’Œé€Ÿåº¦ä¹‹é—´å®ç°äº†æ›´å¥½çš„å¹³è¡¡ã€‚è¯·å‚é˜…æˆ‘ä»¬çš„ **[æŠ€æœ¯æŠ¥å‘Šv1.0](docs/report_01.md)**ä»¥äº†è§£æ›´å¤šè®¨è®ºã€‚
âœ… æ”¯æŒå‰ªè¾‘å’ŒT5æ–‡æœ¬è°ƒèŠ‚ã€‚
âœ… é€šè¿‡å°†å›¾åƒè§†ä¸ºå•å¸§è§†é¢‘ï¼Œæˆ‘ä»¬çš„é¡¹ç›®æ”¯æŒåœ¨å›¾åƒå’Œè§†é¢‘ä¸Šè®­ç»ƒ DiTï¼ˆä¾‹å¦‚ ImageNet å’Œ UCF101ï¼‰ã€‚æœ‰å…³æ›´å¤šè¯´æ˜ï¼Œè¯·å‚é˜…[commands.md](docs/commands.md) ã€‚
âœ… æ”¯æŒä½¿ç”¨[DiT](https://github.com/facebookresearch/DiT), [Latte](https://github.com/Vchitect/Latte),
  å’Œ [PixArt](https://pixart-alpha.github.io/).çš„å®˜æ–¹æƒé‡è¿›è¡Œæ¨ç†ã€‚
âœ… é‡æ„ä»£ç åº“ã€‚æŸ¥çœ‹[structure.md](docs/structure.md)ä»¥äº†è§£é¡¹ç›®ç»“æ„ä»¥åŠå¦‚ä½•ä½¿ç”¨é…ç½®æ–‡ä»¶ã€‚

</details>

### æŒ‰ä¼˜å…ˆçº§æ’åºçš„ TODO åˆ—è¡¨

<details>
<summary>æŸ¥çœ‹æ›´å¤š</summary>

* [x] è®­ç»ƒè§†é¢‘ VAE å¹¶ä½¿æˆ‘ä»¬çš„æ¨¡å‹é€‚åº”æ–°çš„ VAE
* [x] ç¼©æ”¾æ¨¡å‹å‚æ•°å’Œæ•°æ®é›†å¤§å°
* [x] çº³å…¥æ›´å¥½çš„è°ƒåº¦ç¨‹åºï¼ˆæ•´æµæµç¨‹ï¼‰
* [x] è¯„ä¼°æµç¨‹
* [x] å®Œæˆæ•°æ®å¤„ç†æµç¨‹ï¼ˆåŒ…æ‹¬å¯†é›†å…‰æµã€ç¾å­¦è¯„åˆ†ã€æ–‡æœ¬-å›¾åƒç›¸ä¼¼åº¦ç­‰ï¼‰ã€‚æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…[æ•°æ®é›†](/docs/datasets.md)
* [x] æ”¯æŒå›¾åƒå’Œè§†é¢‘è°ƒèŠ‚
* [x] æ”¯æŒå¯å˜çš„çºµæ¨ªæ¯”ã€åˆ†è¾¨ç‡å’ŒæŒç»­æ—¶é—´

</details>

## å†…å®¹

* [å®‰è£…](#å®‰è£…)
* [æ¨¡å‹æƒé‡](#æ¨¡å‹æƒé‡)
* [Gradioæ¼”ç¤º](#gradioæ¼”ç¤º)
* [æ¨ç†](#æ¨ç†)
* [æ•°æ®å¤„ç†](#æ•°æ®å¤„ç†)
* [è®­ç»ƒ](#è®­ç»ƒ)
* [è¯„ä¼°](#è¯„ä¼°)
* [è´¡çŒ®](#è´¡çŒ®)
* [å¼•ç”¨](#å¼•ç”¨)
* [è‡´è°¢](#è‡´è°¢)

ä¸‹é¢åˆ—å‡ºäº†å…¶ä»–æœ‰ç”¨çš„æ–‡æ¡£å’Œé“¾æ¥ã€‚

* æŠ¥å‘Š: [æŠ€æœ¯æŠ¥å‘Š v1.2](docs/report_v3.md), [æŠ€æœ¯æŠ¥å‘Š v1.1](/docs/report_v2.md), [æŠ€æœ¯æŠ¥å‘Š v1.0](/docs/report_v1.md), [è®­ç»ƒåŠ é€Ÿ.md](docs/acceleration.md)
* Repo ç»“æ„: [ç»“æ„.md](docs/structure.md)
* é…ç½®æ–‡ä»¶è¯´æ˜: [config.md](docs/config.md)
* Useful commands: [commands.md](docs/commands.md)
* æ•°æ®å¤„ç†ç®¡é“å’Œæ•°æ®é›†: [datasets.md](docs/datasets.md)
* æ¯ä¸ªæ•°æ®å¤„ç†å·¥å…·çš„ README: [dataset conventions and management](/tools/datasets/README.md), [scene cutting](/tools/scene_cut/README.md), [scoring](/tools/scoring/README.md), [caption](/tools/caption/README.md)
* è¯„ä¼°: [eval](/eval/README.md)
* ç”»å»Š: [gallery](https://hpcaitech.github.io/Open-Sora/)

## å®‰è£…

### ä»æºå¤´å®‰è£…

å¯¹äº CUDA 12.1ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤[å®‰è£…](/docs/installation.md)ä¾èµ–é¡¹ã€‚å¦åˆ™ï¼Œè¯·å‚é˜…å®‰è£…ä»¥è·å–æœ‰å…³ä¸åŒ cuda ç‰ˆæœ¬çš„æ›´å¤šè¯´æ˜ä»¥åŠæ•°æ®é¢„å¤„ç†çš„å…¶ä»–ä¾èµ–é¡¹ã€‚

```bash
# create a virtual env and activate (conda as an example)
conda create -n opensora python=3.9
conda activate opensora

# install torch, torchvision and xformers
pip install -r requirements/requirements-cu121.txt

# download the repo
git clone https://github.com/hpcaitech/Open-Sora
cd Open-Sora

# the default installation is for inference only
pip install -v . # for development mode, `pip install -v -e .`


(Optional, recommended for fast speed, especially for training) To enable `layernorm_kernel` and `flash_attn`, you need to install `apex` and `flash-attn` with the following commands.

```bash
# install flash attention
# set enable_flash_attn=False in config to disable flash attention
pip install packaging ninja
pip install flash-attn --no-build-isolation

# install apex
# set enable_layernorm_kernel=False in config to disable apex
pip install -v --disable-pip-version-check --no-cache-dir --no-build-isolation --config-settings "--build-option=--cpp_ext" --config-settings "--build-option=--cuda_ext" git+https://github.com/NVIDIA/apex.git
```

### ä½¿ç”¨Docker

è¿è¡Œä»¥ä¸‹å‘½ä»¤ä»æä¾›çš„Dockerfile æ„å»ºdocker é•œåƒã€‚

```bash
docker build -t opensora .
```

è¿è¡Œä»¥ä¸‹å‘½ä»¤ä»¥äº¤äº’æ¨¡å¼å¯åŠ¨dockerå®¹å™¨ã€‚

```bash
docker run -ti --gpus all -v .:/workspace/Open-Sora opensora
```

## æ¨¡å‹æƒé‡

### Open-Sora 1.2 æ¨¡å‹æƒé‡
| åˆ†è¾¨ç‡ | æ¨¡å‹å¤§å° | æ•°æ® | è¿­ä»£æ¬¡æ•° | æ‰¹æ¬¡å¤§å° | ç½‘å€ |
| ---------- | ---------- | ---- | ----------- | ---------- | --- |
| Diffusion | 1.1B       | 30M  | 70k         | åŠ¨æ€å¤§å°    | [:link:](https://huggingface.co/hpcai-tech/OpenSora-STDiT-v3) |
| VAE       | 384M       | 3M   | 1M          | 8          | [:link:](https://huggingface.co/hpcai-tech/OpenSora-VAE-v1.2) |

è¯·å‚é˜…æˆ‘ä»¬çš„**[report 1.2](docs/report_v3.md)**ä»¥äº†è§£æ›´å¤šä¿¡æ¯ã€‚

### Open-Sora 1.1 æ¨¡å‹æƒé‡

<details>
<summary>æŸ¥çœ‹æ›´å¤š</summary>

| åˆ†è¾¨ç‡         | M | Data                       | #iterations | Batch Size                                        | URL                                                                  |
| ------------------ | ---------- | -------------------------- | ----------- | ------------------------------------------------- | -------------------------------------------------------------------- |
| mainly 144p & 240p | 700M       | 10M videos + 2M images     | 100k        | [dynamic](/configs/opensora-v1-1/train/stage2.py) | [:link:](https://huggingface.co/hpcai-tech/OpenSora-STDiT-v2-stage2) |
| 144p to 720p       | 700M       | 500K HQ videos + 1M images | 4k          | [dynamic](/configs/opensora-v1-1/train/stage3.py) | [:link:](https://huggingface.co/hpcai-tech/OpenSora-STDiT-v2-stage3) |

è¯·å‚é˜…æˆ‘ä»¬çš„ **[æŠ¥å‘Š 1.1](docs/report_02.md)** ä»¥äº†è§£æ›´å¤šä¿¡æ¯ã€‚

:warning: **å±€é™æ€§**: æ­¤ç‰ˆæœ¬åŒ…å«å·²çŸ¥é—®é¢˜ï¼Œæˆ‘ä»¬å°†åœ¨ä¸‹ä¸€ç‰ˆæœ¬ä¸­ä¿®å¤è¿™äº›é—®é¢˜ï¼ˆå› ä¸ºæˆ‘ä»¬ä¸ºä¸‹ä¸€ç‰ˆæœ¬èŠ‚çœäº†è®¡ç®—èµ„æºï¼‰ã€‚æ­¤å¤–ï¼Œç”±äºæ­¤é—®é¢˜ï¼Œè§†é¢‘ç”Ÿæˆå¯èƒ½ä¼šé•¿æ—¶é—´å¤±è´¥ï¼Œé«˜åˆ†è¾¨ç‡å°†äº§ç”Ÿå˜ˆæ‚çš„ç»“æœã€‚

</details>

### Open-Sora 1.0 æ¨¡å‹æƒé‡
<details>
<summary>æŸ¥çœ‹æ›´å¤š</summary>

| åˆ†è¾¨ç‡ | æ¨¡å‹å¤§å° | æ•°æ®   | è¿­ä»£æ¬¡æ•° | æ‰¹é‡å¤§å° | GPU å¤©æ•° (H800) | ç½‘å€
| ---------- | ---------- | ------ | ----------- | ---------- | --------------- |
| 16Ã—512Ã—512 | 700M       | 20K HQ | 20k         | 2Ã—64       | 35              | [:link:](https://huggingface.co/hpcai-tech/Open-Sora/blob/main/OpenSora-v1-HQ-16x512x512.pth) |
| 16Ã—256Ã—256 | 700M       | 20K HQ | 24k         | 8Ã—64       | 45              | [:link:](https://huggingface.co/hpcai-tech/Open-Sora/blob/main/OpenSora-v1-HQ-16x256x256.pth) |
| 16Ã—256Ã—256 | 700M       | 366K   | 80k         | 8Ã—64       | 117             | [:link:](https://huggingface.co/hpcai-tech/Open-Sora/blob/main/OpenSora-v1-16x256x256.pth)    |

è®­ç»ƒæµç¨‹: 16x256x256 $\rightarrow$ 16x256x256 é«˜æ¸… $\rightarrow$ 16x512x512 é«˜è´¨é‡.

æˆ‘ä»¬çš„æ¨¡å‹æƒé‡éƒ¨åˆ†ç”± [PixArt-Î±](https://github.com/PixArt-alpha/PixArt-alpha)åˆå§‹åŒ–ï¼Œå‚æ•°æ•°é‡ä¸º724M.æ›´å¤šä¿¡æ¯è¯·å‚é˜…  **[æŠ€æœ¯æŠ¥å‘Šv1.0](docs/report_v1.md)**ã€‚æ•°æ®é›†ç›¸å…³ä¿¡æ¯è¯·å‚é˜…[æ•°æ®é›†æ–‡ä»¶](docs/datasets.md). HQ è¡¨ç¤ºé«˜è´¨é‡.

:warning: **å±€é™æ€§**: æˆ‘ä»¬çš„æ¨¡å‹æ˜¯åœ¨æœ‰é™çš„é¢„ç®—ä¸‹è®­ç»ƒçš„ã€‚è´¨é‡å’Œæ–‡æœ¬å¯¹é½ç›¸å¯¹è¾ƒå·®ã€‚è¯¥æ¨¡å‹è¡¨ç°ä¸ä½³ï¼Œç‰¹åˆ«æ˜¯åœ¨ç”Ÿæˆäººç±»æ—¶ï¼Œæ— æ³•éµå¾ªè¯¦ç»†çš„è¯´æ˜ã€‚æˆ‘ä»¬æ­£åœ¨åŠªåŠ›æé«˜è´¨é‡å’Œæ–‡æœ¬å¯¹é½ã€‚

</details>

## Gradioæ¼”ç¤º

ğŸ”¥ æ‚¨å¯ä»¥åœ¨Hugging Face ä¸Šçš„[ğŸ¤— Gradio åº”ç”¨ç¨‹åº](https://huggingface.co/spaces/hpcai-tech/open-sora)ä¸Šåœ¨çº¿ä½“éªŒOpen-Soraã€‚ã€ç”±äºGPUèµ„æºä¸è¶³ï¼Œå·²å¤±æ•ˆã€‘

### æœ¬åœ°éƒ¨ç½²

å¦‚æœæ‚¨æƒ³åœ¨æœ¬åœ°éƒ¨ç½² gradioï¼Œæˆ‘ä»¬è¿˜åœ¨è¿™ä¸ªå­˜å‚¨åº“ä¸­æä¾›äº†ä¸€ä¸ª[Gradio åº”ç”¨ç¨‹åº](./gradio) ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯åŠ¨ä¸€ä¸ªäº¤äº’å¼ Web åº”ç”¨ç¨‹åºæ¥ä½“éªŒä½¿ç”¨ Open-Sora ç”Ÿæˆè§†é¢‘ã€‚

```bash
pip install gradio spaces
python gradio/app.py
```

è¿™å°†åœ¨æ‚¨çš„æœ¬åœ°ä¸»æœºä¸Šå¯åŠ¨ Gradio åº”ç”¨ç¨‹åºã€‚å¦‚æœæ‚¨æƒ³äº†è§£æœ‰å…³ Gradio åº”ç”¨ç¨‹åºçš„æ›´å¤šä¿¡æ¯ï¼Œå¯ä»¥å‚è€ƒ[Gradio README](./gradio/README.md)ã€‚

è¦å¯ç”¨æç¤ºå¢å¼ºå’Œå…¶ä»–è¯­è¨€è¾“å…¥ï¼ˆä¾‹å¦‚ä¸­æ–‡è¾“å…¥ï¼‰ï¼Œæ‚¨éœ€è¦OPENAI_API_KEYåœ¨ç¯å¢ƒä¸­è¿›è¡Œè®¾ç½®ã€‚æŸ¥çœ‹[OpenAIçš„æ–‡æ¡£](https://platform.openai.com/docs/quickstart)ä»¥è·å–æ‚¨çš„ API å¯†é’¥ã€‚

```bash
export OPENAI_API_KEY=YOUR_API_KEY
```

### å…¥é—¨

åœ¨ Gradio åº”ç”¨ç¨‹åºä¸­ï¼ŒåŸºæœ¬é€‰é¡¹å¦‚ä¸‹ï¼š

![Gradio Demo](/assets/readme/gradio_basic.png)

ç”Ÿæˆè§†é¢‘æœ€ç®€å•çš„æ–¹å¼æ˜¯è¾“å…¥æ–‡æœ¬æç¤ºï¼Œç„¶åç‚¹å‡»â€œ**ç”Ÿæˆè§†é¢‘**â€æŒ‰é’®ï¼ˆå¦‚æœæ‰¾ä¸åˆ°ï¼Œè¯·å‘ä¸‹æ»šåŠ¨ï¼‰ã€‚ç”Ÿæˆçš„è§†é¢‘å°†æ˜¾ç¤ºåœ¨å³ä¾§é¢æ¿ä¸­ã€‚å‹¾é€‰â€œ**ä½¿ç”¨ GPT4o å¢å¼ºæç¤º**â€å°†ä½¿ç”¨ GPT-4o æ¥ç»†åŒ–æç¤ºï¼Œè€Œâ€œ**éšæœºæç¤º**â€æŒ‰é’®å°†ç”± GPT-4o ä¸ºæ‚¨ç”Ÿæˆéšæœºæç¤ºã€‚ç”±äº OpenAI çš„ API é™åˆ¶ï¼Œæç¤ºç»†åŒ–ç»“æœå…·æœ‰ä¸€å®šçš„éšæœºæ€§ã€‚

ç„¶åï¼Œä½ å¯ä»¥é€‰æ‹©ç”Ÿæˆè§†é¢‘çš„**åˆ†è¾¨ç‡**ã€**æ—¶é•¿**ã€**é•¿å®½æ¯”**ã€‚ä¸åŒçš„åˆ†è¾¨ç‡å’Œè§†é¢‘é•¿åº¦ä¼šå½±å“è§†é¢‘ç”Ÿæˆé€Ÿåº¦ã€‚åœ¨ 80G H100 GPU ä¸Šï¼Œç”Ÿæˆé€Ÿåº¦å’Œå³°å€¼å†…å­˜ä½¿ç”¨é‡ä¸ºï¼š

|   åˆ†è¾¨ç‡   | å›¾åƒ   | 2ç§’       | 4ç§’        | 8ç§’        | 16ç§’       |
| ---- | ------- | -------- | --------- | --------- | --------- |
| 360p | 3s, 24G | 18s, 27G | 31s, 27G  | 62s, 28G  | 121s, 33G |
| 480p | 2s, 24G | 29s, 31G | 55s, 30G  | 108s, 32G | 219s, 36G |
| 720p | 6s, 27G | 68s, 41G | 130s, 39G | 260s, 45G | 547s, 67G |

æ³¨æ„ï¼Œé™¤äº†æ–‡æœ¬è½¬è§†é¢‘ï¼Œä½ è¿˜å¯ä»¥ä½¿ç”¨å›¾ç‰‡è½¬è§†é¢‘ã€‚ä½ å¯ä»¥ä¸Šä¼ å›¾ç‰‡ï¼Œç„¶åç‚¹å‡»â€œ**ç”Ÿæˆè§†é¢‘**â€æŒ‰é’®ï¼Œç”Ÿæˆä»¥å›¾ç‰‡ä¸ºç¬¬ä¸€å¸§çš„è§†é¢‘ã€‚æˆ–è€…ï¼Œä½ å¯ä»¥å¡«å†™æ–‡æœ¬æç¤ºï¼Œç„¶åç‚¹å‡»â€œ**ç”Ÿæˆå›¾ç‰‡**â€æŒ‰é’®ï¼Œæ ¹æ®æ–‡æœ¬æç¤ºç”Ÿæˆå›¾ç‰‡ï¼Œç„¶åç‚¹å‡»â€œ**ç”Ÿæˆè§†é¢‘**â€æŒ‰é’®ï¼Œæ ¹æ®åŒä¸€æ¨¡å‹ç”Ÿæˆçš„å›¾ç‰‡ç”Ÿæˆè§†é¢‘ã€‚

![Gradio Demo](/assets/readme/gradio_option.png)

ç„¶åæ‚¨å¯ä»¥æŒ‡å®šæ›´å¤šé€‰é¡¹ï¼ŒåŒ…æ‹¬â€œ**è¿åŠ¨å¼ºåº¦**â€ã€â€œ**ç¾å­¦**â€å’Œâ€œ**ç›¸æœºè¿åŠ¨**â€ã€‚å¦‚æœæœªé€‰ä¸­â€œå¯ç”¨â€æˆ–é€‰æ‹©â€œæ— â€ï¼Œåˆ™ä¸ä¼šå°†ä¿¡æ¯ä¼ é€’ç»™æ¨¡å‹ã€‚å¦åˆ™ï¼Œæ¨¡å‹å°†ç”Ÿæˆå…·æœ‰æŒ‡å®šè¿åŠ¨å¼ºåº¦ã€ç¾å­¦åˆ†æ•°å’Œç›¸æœºè¿åŠ¨çš„è§†é¢‘ã€‚

å¯¹äº**ç¾å­¦åˆ†æ•°**ï¼Œæˆ‘ä»¬å»ºè®®ä½¿ç”¨é«˜äº 6 çš„å€¼ã€‚å¯¹äº**è¿åŠ¨å¼ºåº¦**ï¼Œè¾ƒå°çš„å€¼å°†å¯¼è‡´æ›´å¹³æ»‘ä½†åŠ¨æ€æ€§è¾ƒå·®çš„è§†é¢‘ï¼Œè€Œè¾ƒå¤§çš„å€¼å°†å¯¼è‡´æ›´åŠ¨æ€ä½†å¯èƒ½æ›´æ¨¡ç³Šçš„è§†é¢‘ã€‚å› æ­¤ï¼Œæ‚¨å¯ä»¥å°è¯•ä¸ä½¿ç”¨å®ƒï¼Œç„¶åæ ¹æ®ç”Ÿæˆçš„è§†é¢‘è¿›è¡Œè°ƒæ•´ã€‚å¯¹äº**ç›¸æœºè¿åŠ¨**ï¼Œæœ‰æ—¶æ¨¡å‹æ— æ³•å¾ˆå¥½åœ°éµå¾ªæŒ‡ä»¤ï¼Œæˆ‘ä»¬æ­£åœ¨åŠªåŠ›æ”¹è¿›å®ƒã€‚

æ‚¨è¿˜å¯ä»¥è°ƒæ•´â€œ**é‡‡æ ·æ­¥æ•°**â€ï¼Œè¿™æ˜¯å»å™ªçš„æ¬¡æ•°ï¼Œä¸ç”Ÿæˆé€Ÿåº¦ç›´æ¥ç›¸å…³ã€‚å°äº 30 çš„æ•°å­—é€šå¸¸ä¼šå¯¼è‡´è¾ƒå·®çš„ç”Ÿæˆç»“æœï¼Œè€Œå¤§äº 100 çš„æ•°å­—é€šå¸¸ä¸ä¼šæœ‰æ˜æ˜¾çš„æ”¹å–„ã€‚â€œç§å­â€ç”¨äºå¯é‡å¤æ€§ï¼Œæ‚¨å¯ä»¥å°†å…¶è®¾ç½®ä¸ºå›ºå®šæ•°å­—ä»¥ç”Ÿæˆç›¸åŒçš„è§†é¢‘ã€‚â€œ**CFG æ¯”ä¾‹**â€æ§åˆ¶æ¨¡å‹éµå¾ªæ–‡æœ¬æç¤ºçš„ç¨‹åº¦ï¼Œè¾ƒå°çš„å€¼ä¼šå¯¼è‡´è§†é¢‘æ›´éšæœºï¼Œè€Œè¾ƒå¤§çš„å€¼ä¼šå¯¼è‡´è§†é¢‘æ›´éµå¾ªæ–‡æœ¬ï¼ˆå»ºè®®ä¸º 7ï¼‰ã€‚

å¯¹äºæ›´é«˜çº§çš„ç”¨æ³•ï¼Œæ‚¨å¯ä»¥å‚è€ƒ[Gradio README](./gradio/README.md#advanced-usage).

## æ¨ç†

### Open-Sora 1.2 å‘½ä»¤è¡Œæ¨ç†

åŸºç¡€çš„å‘½ä»¤è¡Œæ¨ç†:

```bash
# text to video
python scripts/inference.py configs/opensora-v1-2/inference/sample.py \
  --num-frames 4s --resolution 720p --aspect-ratio 9:16 \
  --prompt "a beautiful waterfall"
```

æ‚¨å¯ä»¥å‘å‘½ä»¤è¡Œæ·»åŠ æ›´å¤šé€‰é¡¹æ¥å®šåˆ¶ç”Ÿæˆã€‚

```bash
python scripts/inference.py configs/opensora-v1-2/inference/sample.py \
  --num-frames 4s --resolution 720p --aspect-ratio 9:16 \
  --num-sampling-steps 30 --flow 5 --aes 6.5 \
  --prompt "a beautiful waterfall"
```

å¯¹äºå›¾åƒåˆ°è§†é¢‘ç”Ÿæˆå’Œå…¶ä»–åŠŸèƒ½ï¼ŒAPI ä¸ Open-Sora 1.1 å…¼å®¹ã€‚è¯·å‚é˜…[æ­¤å¤„]](commands.md)äº†è§£æ›´å¤šè¯´æ˜ã€‚

å¦‚æœæ‚¨çš„å®‰è£…ä¸åŒ…å« `apex` å’Œ `flash-attn`, åˆ™éœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­æˆ–é€šè¿‡ä»¥ä¸‹å‘½ä»¤ç¦ç”¨å®ƒä»¬ã€‚

```bash
python scripts/inference.py configs/opensora-v1-2/inference/sample.py \
  --num-frames 4s --resolution 720p \
  --layernorm-kernel False --flash-attn False \
  --prompt "a beautiful waterfall"
```

### åºåˆ—å¹¶è¡Œæ¨ç†

è¦å¯ç”¨åºåˆ—å¹¶è¡Œï¼Œæ‚¨éœ€è¦ä½¿ç”¨ `torchrun` æ¥è¿è¡Œæ¨ç†è„šæœ¬ã€‚ä»¥ä¸‹å‘½ä»¤å°†ä½¿ç”¨ 2 ä¸ª GPU è¿è¡Œæ¨ç†ã€‚

```bash
# text to video
CUDA_VISIBLE_DEVICES=0,1 torchrun --nproc_per_node 2 scripts/inference.py configs/opensora-v1-2/inference/sample.py \
  --num-frames 4s --resolution 720p --aspect-ratio 9:16 \
  --prompt "a beautiful waterfall"
```

:warning: **æ³¨æ„**: gradio éƒ¨ç½²ä¸æ”¯æŒåºåˆ—å¹¶è¡Œã€‚ç›®å‰ï¼Œåªæœ‰å½“ç»´åº¦å¯ä»¥é™¤ä»¥ GPU æ•°é‡æ—¶æ‰æ”¯æŒåºåˆ—å¹¶è¡Œã€‚å› æ­¤ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹å¯èƒ½ä¼šå¤±è´¥ã€‚æˆ‘ä»¬æµ‹è¯•äº† 4 ä¸ª GPU ç”¨äº 720p å’Œ 2 ä¸ª GPU ç”¨äº 480pã€‚


### GPT-4o å¿«é€Ÿç»†åŒ–

æˆ‘ä»¬å‘ç° GPT-4o å¯ä»¥ç»†åŒ–æç¤ºå¹¶æé«˜ç”Ÿæˆè§†é¢‘çš„è´¨é‡ã€‚åˆ©ç”¨æ­¤åŠŸèƒ½ï¼Œæ‚¨è¿˜å¯ä»¥ä½¿ç”¨å…¶ä»–è¯­è¨€ï¼ˆä¾‹å¦‚ä¸­æ–‡ï¼‰ä½œä¸ºæç¤ºã€‚è¦å¯ç”¨æ­¤åŠŸèƒ½ï¼Œæ‚¨éœ€è¦åœ¨ç¯å¢ƒä¸­å‡†å¤‡æ‚¨çš„ openai api å¯†é’¥ï¼š

```bash
export OPENAI_API_KEY=YOUR_API_KEY
```

ç„¶åæ‚¨å¯ä»¥ç”¨ `--llm-refine True` å¯ç”¨GPT-4oè¿›è¡Œæç¤ºç»†åŒ–ä»¥å®Œæˆæ¨ç†ã€‚

### Open-Sora 1.1 å‘½ä»¤è¡Œæ¨ç†
<details>
<summary>æŸ¥çœ‹æ›´å¤š</summary>

ç”±äº Open-Sora 1.1 æ”¯æŒåŠ¨æ€è¾“å…¥å¤§å°çš„æ¨ç†ï¼Œå› æ­¤æ‚¨å¯ä»¥å°†è¾“å…¥å¤§å°ä½œä¸ºå‚æ•°ä¼ é€’ã€‚

```bash
# text to video
python scripts/inference.py configs/opensora-v1-1/inference/sample.py --prompt "A beautiful sunset over the city" --num-frames 32 --image-size 480 854
```

å¦‚æœæ‚¨çš„å®‰è£…ä¸åŒ…å«`apex` å’Œ `flash-attn`ï¼Œåˆ™éœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­æˆ–é€šè¿‡ä»¥ä¸‹å‘½ä»¤ç¦ç”¨å®ƒä»¬ã€‚

```bash
python scripts/inference.py configs/opensora-v1-1/inference/sample.py --prompt "A beautiful sunset over the city" --num-frames 32 --image-size 480 854 --layernorm-kernel False --flash-attn False
```

è¯·å‚é˜…[æ­¤å¤„](docs/commands.md#inference-with-open-sora-11)äº†è§£æ›´å¤šè¯´æ˜ï¼ŒåŒ…æ‹¬æ–‡æœ¬è½¬å›¾åƒã€å›¾åƒè½¬è§†é¢‘ã€è§†é¢‘è½¬è§†é¢‘å’Œæ— é™æ—¶é—´ç”Ÿæˆã€‚

</details>

### Open-Sora 1.0 å‘½ä»¤è¡Œæ¨ç†

<details>
<summary>æŸ¥çœ‹æ›´å¤š</summary>

æˆ‘ä»¬è¿˜æä¾›äº†ç¦»çº¿æ¨ç†è„šæœ¬ã€‚è¿è¡Œä»¥ä¸‹å‘½ä»¤ç”Ÿæˆæ ·æœ¬ï¼Œæ‰€éœ€çš„æ¨¡å‹æƒé‡å°†è‡ªåŠ¨ä¸‹è½½ã€‚è¦æ›´æ”¹é‡‡æ ·æç¤ºï¼Œè¯·ä¿®æ”¹ä¼ é€’ç»™çš„ txt æ–‡ä»¶--prompt-pathã€‚è¯·å‚é˜…[æ­¤å¤„](docs/structure.md#inference-config-demos)ä»¥è‡ªå®šä¹‰é…ç½®ã€‚

```bash
# Sample 16x512x512 (20s/sample, 100 time steps, 24 GB memory)
torchrun --standalone --nproc_per_node 1 scripts/inference.py configs/opensora/inference/16x512x512.py --ckpt-path OpenSora-v1-HQ-16x512x512.pth --prompt-path ./assets/texts/t2v_samples.txt

# Sample 16x256x256 (5s/sample, 100 time steps, 22 GB memory)
torchrun --standalone --nproc_per_node 1 scripts/inference.py configs/opensora/inference/16x256x256.py --ckpt-path OpenSora-v1-HQ-16x256x256.pth --prompt-path ./assets/texts/t2v_samples.txt

# Sample 64x512x512 (40s/sample, 100 time steps)
torchrun --standalone --nproc_per_node 1 scripts/inference.py configs/opensora/inference/64x512x512.py --ckpt-path ./path/to/your/ckpt.pth --prompt-path ./assets/texts/t2v_samples.txt

# Sample 64x512x512 with sequence parallelism (30s/sample, 100 time steps)
# sequence parallelism is enabled automatically when nproc_per_node is larger than 1
torchrun --standalone --nproc_per_node 2 scripts/inference.py configs/opensora/inference/64x512x512.py --ckpt-path ./path/to/your/ckpt.pth --prompt-path ./assets/texts/t2v_samples.txt
```

é€Ÿåº¦æ˜¯åœ¨ H800 GPU ä¸Šæµ‹è¯•çš„ã€‚æœ‰å…³ä½¿ç”¨å…¶ä»–å‹å·è¿›è¡Œæ¨ç†ï¼Œè¯·å‚é˜…[æ­¤å¤„](docs/commands.md) äº†è§£æ›´å¤šè¯´æ˜ã€‚è¦é™ä½å†…å­˜ä½¿ç”¨é‡ï¼Œè¯·`vae.micro_batch_size`åœ¨é…ç½®ä¸­è®¾ç½®è¾ƒå°çš„å€¼ï¼ˆç•¥ä½é‡‡æ ·é€Ÿåº¦ï¼‰ã€‚

</details>

## æ•°æ®å¤„ç†

é«˜è´¨é‡çš„æ•°æ®å¯¹äºè®­ç»ƒè‰¯å¥½çš„ç”Ÿæˆæ¨¡å‹è‡³å…³é‡è¦ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å»ºç«‹äº†å®Œæ•´çš„æ•°æ®å¤„ç†æµç¨‹ï¼Œå¯ä»¥å°†åŸå§‹è§†é¢‘æ— ç¼è½¬æ¢ä¸ºé«˜è´¨é‡çš„è§†é¢‘-æ–‡æœ¬å¯¹ã€‚æµç¨‹å¦‚ä¸‹æ‰€ç¤ºã€‚æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…[æ•°æ®å¤„ç†](docs/data_processing.md)ã€‚å¦è¯·æŸ¥çœ‹æˆ‘ä»¬ä½¿ç”¨çš„[æ•°æ®é›†](docs/datasets.md)ã€‚

![Data Processing Pipeline](/assets/readme/report_data_pipeline.png)

## è®­ç»ƒ

### Open-Sora 1.2 è®­ç»ƒ

è®­ç»ƒè¿‡ç¨‹ä¸Open-Sora 1.1ç›¸åŒã€‚

```bash
# one node
torchrun --standalone --nproc_per_node 8 scripts/train.py \
    configs/opensora-v1-2/train/stage1.py --data-path YOUR_CSV_PATH --ckpt-path YOUR_PRETRAINED_CKPT
# multiple nodes
colossalai run --nproc_per_node 8 --hostfile hostfile scripts/train.py \
    configs/opensora-v1-2/train/stage1.py --data-path YOUR_CSV_PATH --ckpt-path YOUR_PRETRAINED_CKPT
```

### Open-Sora 1.1 è®­ç»ƒ

<details>
<summary>æŸ¥çœ‹æ›´å¤š</summary>

åœ¨æ–‡ä»¶ä¸­å‡†å¤‡å¥½æ•°æ®å`csv`ï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤åœ¨å•ä¸ªèŠ‚ç‚¹ä¸Šå¯åŠ¨è®­ç»ƒã€‚

```bash
# one node
torchrun --standalone --nproc_per_node 8 scripts/train.py \
    configs/opensora-v1-1/train/stage1.py --data-path YOUR_CSV_PATH --ckpt-path YOUR_PRETRAINED_CKPT
# multiple nodes
colossalai run --nproc_per_node 8 --hostfile hostfile scripts/train.py \
    configs/opensora-v1-1/train/stage1.py --data-path YOUR_CSV_PATH --ckpt-path YOUR_PRETRAINED_CKPT
```

</details>

### Open-Sora 1.0 è®­ç»ƒ

<details>
<summary>æŸ¥çœ‹æ›´å¤š</summary>

åœ¨æ–‡ä»¶ä¸­å‡†å¤‡å¥½æ•°æ®å`csv`ï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤åœ¨å•ä¸ªèŠ‚ç‚¹ä¸Šå¯åŠ¨è®­ç»ƒã€‚

```bash
# 1 GPU, 16x256x256
torchrun --nnodes=1 --nproc_per_node=1 scripts/train.py configs/opensora/train/16x256x256.py --data-path YOUR_CSV_PATH
# 8 GPUs, 64x512x512
torchrun --nnodes=1 --nproc_per_node=8 scripts/train.py configs/opensora/train/64x512x512.py --data-path YOUR_CSV_PATH --ckpt-path YOUR_PRETRAINED_CKPT
```

è¦åœ¨å¤šä¸ªèŠ‚ç‚¹ä¸Šå¯åŠ¨è®­ç»ƒï¼Œè¯·æ ¹æ®[ColossalAI](https://colossalai.org/docs/basics/launch_colossalai/#launch-with-colossal-ai-cli)å‡†å¤‡ä¸€ä¸ªä¸»æœºæ–‡ä»¶ï¼Œå¹¶è¿è¡Œä»¥ä¸‹å‘½ä»¤ã€‚

```bash
colossalai run --nproc_per_node 8 --hostfile hostfile scripts/train.py configs/opensora/train/64x512x512.py --data-path YOUR_CSV_PATH --ckpt-path YOUR_PRETRAINED_CKPT
```
æœ‰å…³è®­ç»ƒå…¶ä»–æ¨¡å‹å’Œé«˜çº§ç”¨æ³•ï¼Œè¯·å‚é˜…[æ­¤å¤„](docs/commands.md)è·å–æ›´å¤šè¯´æ˜ã€‚

</details>

## è¯„ä¼°

æˆ‘ä»¬æ”¯æŒåŸºäºä»¥ä¸‹æ–¹é¢çš„è¯„ä¼°ï¼š

- éªŒè¯æŸå¤±
- [VBench](https://github.com/Vchitect/VBench/tree/master)håˆ†æ•°
- VBench-i2v åˆ†æ•°
- æ‰¹é‡ç”Ÿæˆä»¥ä¾›äººå·¥è¯„ä¼°
æ‰€æœ‰è¯„ä¼°ä»£ç å‡å‘å¸ƒåœ¨ `eval`æ–‡ä»¶å¤¹ä¸­ã€‚æŸ¥çœ‹[README](/eval/README.md)äº†è§£æ›´å¤šè¯¦ç»†ä¿¡æ¯ã€‚æˆ‘ä»¬çš„ [æŠ€æœ¯æŠ¥å‘Š](report_v3.md#è¯„ä¼°)è¿˜æä¾›äº†æœ‰å…³è®­ç»ƒæœŸé—´è¯„ä¼°çš„æ›´å¤šä¿¡æ¯ã€‚ä¸‹è¡¨æ˜¾ç¤º Open-Sora 1.2 å¤§å¤§æ”¹è¿›äº† Open-Sora 1.0ã€‚

| æ¨¡å‹          | æ€»å¾—åˆ† | è´¨é‡å¾—åˆ† | è¯­ä¹‰å¾—åˆ† |
| -------------- | ----------- | ------------- | -------------- |
| Open-Sora V1.0 | 75.91%      | 78.81%        | 64.28%         |
| Open-Sora V1.2 | 79.23%      | 80.71%        | 73.30%         |

## VAE è®­ç»ƒä¸è¯„ä¼°

æˆ‘ä»¬è®­ç»ƒä¸€ä¸ªç”±ç©ºé—´ VAE å’Œæ—¶é—´ VAE ç»„æˆçš„ VAE ç®¡é“ã€‚æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…[VAE æ–‡æ¡£](vae.md)ã€‚åœ¨è¿è¡Œä»¥ä¸‹å‘½ä»¤ä¹‹å‰ï¼Œè¯·æŒ‰ç…§æˆ‘ä»¬çš„[å®‰è£…æ–‡æ¡£](installation.md)å®‰è£… VAE å’Œè¯„ä¼°æ‰€éœ€çš„ä¾èµ–é¡¹ã€‚

å¦‚æœæ‚¨æƒ³è®­ç»ƒè‡ªå·±çš„ VAEï¼Œæˆ‘ä»¬éœ€è¦æŒ‰ç…§[æ•°æ®å¤„ç†](#data-processing)æµç¨‹åœ¨ csv ä¸­å‡†å¤‡æ•°æ®ï¼Œç„¶åè¿è¡Œä»¥ä¸‹å‘½ä»¤ã€‚è¯·æ³¨æ„ï¼Œæ‚¨éœ€è¦æ ¹æ®è‡ªå·±çš„ csv æ•°æ®å¤§å°ç›¸åº”åœ°è°ƒæ•´é…ç½®æ–‡ä»¶ä¸­çš„è®­ç»ƒ`epochs`æ•°é‡ã€‚


```bash
# stage 1 training, 380k steps, 8 GPUs
torchrun --nnodes=1 --nproc_per_node=8 scripts/train_vae.py configs/vae/train/stage1.py --data-path YOUR_CSV_PATH
# stage 2 training, 260k steps, 8 GPUs
torchrun --nnodes=1 --nproc_per_node=8 scripts/train_vae.py configs/vae/train/stage2.py --data-path YOUR_CSV_PATH
# stage 3 training, 540k steps, 24 GPUs
torchrun --nnodes=3 --nproc_per_node=8 scripts/train_vae.py configs/vae/train/stage3.py --data-path YOUR_CSV_PATH
```

ä¸ºäº†è¯„ä¼° VAE çš„æ€§èƒ½ï¼Œæ‚¨éœ€è¦é¦–å…ˆè¿è¡Œ VAE æ¨ç†æ¥ç”Ÿæˆè§†é¢‘ï¼Œç„¶åè®¡ç®—ç”Ÿæˆçš„è§†é¢‘çš„åˆ†æ•°ï¼š

```bash
# video generation
torchrun --standalone --nnodes=1 --nproc_per_node=1 scripts/inference_vae.py configs/vae/inference/video.py --ckpt-path YOUR_VAE_CKPT_PATH --data-path YOUR_CSV_PATH --save-dir YOUR_VIDEO_DIR
# the original videos will be saved to `YOUR_VIDEO_DIR_ori`
# the reconstructed videos through the pipeline will be saved to `YOUR_VIDEO_DIR_rec`
# the reconstructed videos through the spatial VAE only will be saved to `YOUR_VIDEO_DIR_spatial`

# score calculation
python eval/vae/eval_common_metric.py --batch_size 2 --real_video_dir YOUR_VIDEO_DIR_ori --generated_video_dir YOUR_VIDEO_DIR_rec --device cuda --sample_fps 24 --crop_size 256 --resolution 256 --num_frames 17 --sample_rate 1 --metric ssim psnr lpips flolpips
```


## è´¡çŒ®

æ„Ÿè°¢ä»¥ä¸‹å‡ºè‰²çš„è´¡çŒ®è€…ï¼š

<a href="https://github.com/hpcaitech/Open-Sora/graphs/contributors">
  <img src="https://contrib.rocks/image?repo=hpcaitech/Open-Sora" />
</a>

å¦‚æœæ‚¨å¸Œæœ›ä¸ºè¯¥é¡¹ç›®åšå‡ºè´¡çŒ®ï¼Œè¯·å‚é˜…[Contribution Guideline](./CONTRIBUTING.md)ã€‚

## è‡´è°¢

è¿™é‡Œæˆ‘ä»¬ä»…åˆ—å‡ºäº†éƒ¨åˆ†é¡¹ç›®ï¼Œå…¶ä»–ç ”ç©¶æˆæœåŠæ•°æ®é›†è¯·å‚è€ƒæˆ‘ä»¬çš„æŠ¥å‘Šã€‚

* [ColossalAI](https://github.com/hpcaitech/ColossalAI): å¼ºå¤§çš„å¤§å‹æ¨¡å‹å¹¶è¡ŒåŠ é€Ÿä¸ä¼˜åŒ–ç³»ç»Ÿã€‚
* [DiT](https://github.com/facebookresearch/DiT): å¸¦æœ‰ Transformer çš„å¯æ‰©å±•æ‰©æ•£æ¨¡å‹ã€‚
* [OpenDiT](https://github.com/NUS-HPC-AI-Lab/OpenDiT): DiT è®­ç»ƒçš„åŠ é€Ÿå™¨ã€‚æˆ‘ä»¬ä» OpenDiT ä¸­é‡‡ç”¨äº†æœ‰ä»·å€¼çš„è®­ç»ƒè¿›åº¦åŠ é€Ÿç­–ç•¥ã€‚
* [PixArt](https://github.com/PixArt-alpha/PixArt-alpha): ä¸€ä¸ªåŸºäº DiT çš„å¼€æºæ–‡æœ¬è½¬å›¾åƒæ¨¡å‹ã€‚
* [Latte](https://github.com/Vchitect/Latte): å°è¯•é«˜æ•ˆåœ°è®­ç»ƒè§†é¢‘çš„ DiTã€‚
* [StabilityAI VAE](https://huggingface.co/stabilityai/sd-vae-ft-mse-original): ä¸€ä¸ªå¼ºå¤§çš„å›¾åƒ VAE æ¨¡å‹ã€‚
* [CLIP](https://github.com/openai/CLIP): ä¸€ä¸ªå¼ºå¤§çš„æ–‡æœ¬å›¾åƒåµŒå…¥æ¨¡å‹ã€‚
* [T5](https://github.com/google-research/text-to-text-transfer-transformer): å¼ºå¤§çš„æ–‡æœ¬ç¼–ç å™¨ã€‚
* [LLaVA](https://github.com/haotian-liu/LLaVA): åŸºäº[Mistral-7B](https://huggingface.co/mistralai/Mistral-7B-v0.1) å’Œ [Yi-34B](https://huggingface.co/01-ai/Yi-34B). çš„å¼ºå¤§å›¾åƒå­—å¹•æ¨¡å‹ã€‚
* [PLLaVA](https://github.com/magic-research/PLLaVA): ä¸€ä¸ªå¼ºå¤§çš„è§†é¢‘å­—å¹•æ¨¡å‹ã€‚
* [MiraData](https://github.com/mira-space/MiraData):å…·æœ‰é•¿æŒç»­æ—¶é—´å’Œç»“æ„åŒ–å­—å¹•çš„å¤§è§„æ¨¡è§†é¢‘æ•°æ®é›†ã€‚

æˆ‘ä»¬æ„Ÿè°¢ä»–ä»¬çš„å‡ºè‰²å·¥ä½œå’Œå¯¹å¼€æºçš„æ…·æ…¨è´¡çŒ®ã€‚

## å¼•ç”¨

```bibtex
@software{opensora,
  author = {Zangwei Zheng and Xiangyu Peng and Tianji Yang and Chenhui Shen and Shenggui Li and Hongxin Liu and Yukun Zhou and Tianyi Li and Yang You},
  title = {Open-Sora: Democratizing Efficient Video Production for All},
  month = {March},
  year = {2024},
  url = {https://github.com/hpcaitech/Open-Sora}
}
```

## Starå¢é•¿

[![Star History Chart](https://api.star-history.com/svg?repos=hpcaitech/Open-Sora&type=Date)](https://star-history.com/#hpcaitech/Open-Sora&Date)
